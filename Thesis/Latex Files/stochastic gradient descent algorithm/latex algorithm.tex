\documentclass{article}
\usepackage[linesnumbered, ruled, vlined]{algorithm2e}
\usepackage{algpseudocode}
\usepackage[a4paper, total={6in, 8in}]{geometry}


\begin{document}

    \pagenumbering{gobble}
    \setlength{\interspacetitleruled}{-.4pt}
    \begin{algorithm}

    
    \textbf{Input:}
    $\epsilon_{0}$, initial learning rate
    
    \textbf{Input:}
    $\alpha$, decay rate of learning rate
    
    \textbf{Input:}
    $\beta$, momentum rate
    
    \textbf{Input:}
    $m$, minibatch size
    
	\textbf{Input:}
    $k$, epoch size
    
    \textbf{Input:}
    $\theta$, initial weights
    
    \textbf{Input:}
    $v$, initial velocity
     
    \textbf{Input:}
    $apply\_nesterov$, wheather to use Nesterov method or not \{True or False\}
   
    \textbf{Input:}
    $\mathbf{X}$, training dataset inputs
    
    \textbf{Input:}
    $\mathbf{y}$, training dataset targets
    
	$j \gets 1$
	
	\While{$j \leq k$ }{
			
		update learning rate  $\epsilon_{j} \gets \epsilon_{0} + \alpha(\epsilon_{j-1}- \epsilon_{0})$		
		
    		\SetKwRepeat{Do}{do}{while}
		\While{stopping criteria is not satisfied}{

			$\{\mathbf{x}^{1}...\mathbf{x}^{m}\}$, $\{\mathbf{y}^{1}...\mathbf{y}^{m}\} \gets $  get a sample from $\mathbf{X}$ and $\mathbf{y}$ randomly
			
			\If{$apply\_nesterov = True$}{
				
				$\tilde{\theta} \gets \theta + \beta v $
			
				calculate estimation of gradient $\hat{g} \gets \frac{1}{m}\sum_{i = 1}^{m}{L(f(\mathbf{x}^{i}; \tilde{\theta} ), \mathbf{y}^{i})}$		
				
			}
			\Else{
			
				calculate estimation of gradient $\hat{g} \gets \frac{1}{m}\sum_{i = 1}^{m}{L(f(\mathbf{x}^{i}; \theta ), \mathbf{y}^{i})}$		
			
			}


								
			update velocity $v \gets \beta v - \epsilon_{j} \hat{g}$			
			
			update weights $\theta \gets \theta + v$
									
		}
				
		$j \gets j + 1$ go to next epoch 
	
	}        



    \end{algorithm}    
    
\end{document}



